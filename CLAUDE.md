# やまもの冒険 - 3Dボンバーマン風ブラウザゲーム

## 技術スタック
- Three.js（CDN読み込み）
- 1つのindex.htmlをエントリーポイントに、JS/CSSはファイル分割
- レスポンシブ対応（PC + iOS Safari）
- タッチ操作対応必須

## ルール
- ファイルは必ず分割する
- 1機能ずつ実装して動く状態を保つ
- 全機能完成まで止まらず続ける
- 完了した機能は「完了済み」に移動する
- 全てThree.jsによる3D描画、2Dは使わない

## 操作方法
### PC
- 矢印キー / WASD：移動（上下左右）
- スペースキー：爆弾設置
- Escキー：ポーズメニュー

### iOS（タッチ操作）
- 画面左下：バーチャルジョイスティック（移動）
- 画面右下：爆弾ボタン（大きめで押しやすい）
- 画面右上：ポーズボタン
- タッチ領域は親指で操作しやすいサイズにする
- マルチタッチ対応（移動しながら爆弾設置）

## 世界観
坊主頭の「やまも」が爆弾を使って敵を倒しながらステージをクリアしていく。
全5ワールド×5ステージ＝25ステージ構成。
各ワールドの最終ステージにボスがいる。

## 主人公
- 名前：やまも
- 見た目：坊主頭、白い胴着、3Dキャラクター
- 初期能力：爆弾1個、火力1マス、速度ふつう

## ゲームシステム

### 基本ルール
- グリッドベースのマップ（11×13マス）
- 破壊可能ブロック（ソフトブロック）と破壊不可の壁（ハードブロック）
- 爆弾を置いて爆風でソフトブロックと敵を破壊
- 爆風に自分が当たってもミス
- 全ての敵を倒すとステージクリア
- 制限時間3分（時間切れで強制ミス）
- 残機3からスタート、0でゲームオーバー

### 爆弾
- 設置後3秒で爆発
- 爆風は十字方向に広がる
- 爆風はハードブロックで止まる
- ソフトブロックは1つ破壊して爆風が止まる
- 爆弾の誘爆あり（爆風が他の爆弾に当たると連鎖爆発）

### パワーアップアイテム（ソフトブロック破壊で出現）
- 爆弾アップ（同時設置数+1）出現率20%
- 火力アップ（爆風範囲+1マス）出現率20%
- スピードアップ（移動速度UP）出現率15%
- リモコン（爆弾を任意タイミングで起爆、Rキー/画面ダブルタップ）出現率5%
- 貫通（爆風がソフトブロックを貫通する）出現率5%
- 1UP（残機+1）出現率3%
- ドクロ（デバフ、速度低下10秒）出現率10%

## ワールド構成

### ワールド1：草原（チュートリアル）
- 背景：緑の草原、青空
- ブロック：土ブロック
- 敵の数：Stage1-1は2体、1-5は5体
- ステージ1-1〜1-4：通常ステージ
- ステージ1-5：ボス「巨大スライム」
  - HP3（爆弾3回で撃破）
  - 動きが遅い、ランダム移動

### ワールド2：溶岩洞窟
- 背景：赤い溶岩、暗い洞窟
- ブロック：岩ブロック
- 特殊ギミック：溶岩マス（触れるとダメージ、一定間隔で出現/消滅）
- ボス「ファイアゴーレム」
  - HP5
  - 自分で火を吐く（一直線に炎攻撃）
  - 炎は3秒間残る

### ワールド3：氷の城
- 背景：氷と雪、吹雪エフェクト
- ブロック：氷ブロック（破壊時に滑る床が残る）
- 特殊ギミック：滑る床（氷の上は壁にぶつかるまで滑る）
- ボス「アイスドラゴン」
  - HP5
  - 氷のブレス（当たると3秒間移動速度半減）
  - 周囲のマスを凍らせる

### ワールド4：機械要塞
- 背景：メカニカルな工場、歯車
- ブロック：鉄ブロック
- 特殊ギミック：ベルトコンベア（乗ると強制移動）、電撃トラップ
- ボス「メカキング」
  - HP7
  - ミサイル発射（追尾型、壁に当たると爆発）
  - シールド展開（3秒間無敵）

### ワールド5：魔王城
- 背景：ダークな城、紫の空
- ブロック：闇ブロック
- 特殊ギミック：ワープゾーン、視界制限（周囲3マスのみ表示）
- ボス「魔王オニヅカ」
  - HP10
  - 第1形態：高速移動＋爆弾設置（プレイヤーと同じ能力）
  - 第2形態（HP5以下）：瞬間移動＋全方向爆風攻撃
  - 第2形態では闇エフェクトで視界が狭まる

## 敵キャラクター

### 通常敵
1. スライム - 直進して壁で方向転換。速度遅い。1撃で倒せる
2. コウモリ - ランダム移動。速度ふつう。ソフトブロックをすり抜ける
3. ゴーレム - プレイヤーを追尾。速度遅い。爆弾2回で倒せる
4. ニンジャ - 高速移動。速度速い。1撃で倒せる
5. ゴースト - 壁もブロックもすり抜ける。速度ふつう。1撃で倒せる
6. ボムナイト - 自分で爆弾を置いてくる。速度ふつう。1撃で倒せる

### 各ワールドの敵配置
- W1：スライム、コウモリ
- W2：ゴーレム、コウモリ、スライム
- W3：ニンジャ、ゴースト、ゴーレム
- W4：ボムナイト、ニンジャ、ゴースト
- W5：全種類出現

## UI・HUD
- 画面上部：ステージ名、残り時間、スコア
- 画面左上：残機表示
- 画面右上：現在のパワーアップ状態アイコン
- ステージクリア時：スコア表示＋次へボタン
- ゲームオーバー：リトライ / タイトルに戻るボタン

## スコアシステム
- 敵撃破：100点×ワールド番号
- ボス撃破：1000点×ワールド番号
- アイテム取得：50点
- ステージクリアボーナス：残り時間×10点
- ハイスコアはlocalStorageに保存

## 演出
- 爆発エフェクト（パーティクル＋画面シェイク）
- 敵撃破時の消滅アニメーション
- パワーアップ取得時のキラキラエフェクト
- ボス登場時の演出（画面暗転→ボス名表示→戦闘開始）
- ステージクリア時のファンファーレ
- ワールドクリア時の短いストーリーテキスト

## レスポンシブ対応
- PC：フルスクリーン表示、キーボード操作
- iOS/スマホ：画面縦横どちらでも対応（横画面推奨）
- viewportメタタグ設定（ピンチズーム無効）
- タッチ操作のデッドゾーン設定（誤操作防止）
- iOS Safariのバウンススクロール無効化
- 画面サイズに応じてUIサイズ自動調整

## サウンド（Web Audio API）
- BGM：ワールドごとに異なる（シンプルなループ音源を生成）
- SE：爆発音、アイテム取得音、ダメージ音、ステージクリア音
- ミュートボタン付き

## セーブ
- ワールド単位でオートセーブ（localStorage）
- ステージセレクト画面から任意のクリア済みステージを再プレイ可能

## 実装順序
1. プロジェクト構成とタイトル画面
2. 3Dグリッドマップとやまもの移動（PC操作）
3. タッチ操作（バーチャルジョイスティック＋ボタン）
4. 爆弾設置と爆発システム
5. ソフトブロック破壊とアイテムドロップ
6. 敵AI（スライム、コウモリ）
7. 当たり判定（ミス判定、敵撃破）
8. ステージクリア/ゲームオーバー処理
9. ワールド1全5ステージ
10. パワーアップシステム全種
11. 残り敵種（ゴーレム〜ボムナイト）
12. ワールド2〜5のマップとギミック
13. ボス戦全5体
14. スコアとハイスコア
15. サウンド
16. セーブ/ロードとステージセレクト
17. 演出とエフェクト全般
18. バランス調整と最終テスト

## 完了済み
1. プロジェクト構成とタイトル画面
2. 3Dグリッドマップとやまもの移動（PC操作）
3. タッチ操作（バーチャルジョイスティック＋ボタン）
4. 爆弾設置と爆発システム
5. ソフトブロック破壊とアイテムドロップ
6. 敵AI（スライム、コウモリ）
7. 当たり判定（ミス判定、敵撃破）
8. ステージクリア/ゲームオーバー処理
9. ワールド1全5ステージ
10. パワーアップシステム全種
11. 残り敵種（ゴーレム〜ボムナイト）
12. ワールド2〜5のマップとギミック
13. ボス戦全5体
14. スコアとハイスコア
15. サウンド
16. セーブ/ロードとステージセレクト
17. 演出とエフェクト全般
18. バランス調整と最終テスト
